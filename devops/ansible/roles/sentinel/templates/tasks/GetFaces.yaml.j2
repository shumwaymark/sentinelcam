%YAML 1.0
---
# GetFaces.yaml.j2 - Detect faces
# Template for face detection task configuration
#
# Model paths are injected from model_registry.yaml at deployment time.
# Model versions can be overridden per-host in host_vars using model_version_overrides dict.
# Accelerator type and model selection configured in host_vars or role defaults.

trk_type: fd1
all_frames: False         # restrict face detection to images with 'person' detections
camwatcher_update: True

face_detection:
{% if sentinel_accelerator_type == 'coral' %}
    # Coral EdgeTPU Configuration ({{ sentinel_face_detection_model }}{% if sentinel_face_detection_model == 'blazeface' %} {{ sentinel_blazeface_variant }}-range{% endif %})
{% if sentinel_face_detection_model == 'blazeface' %}
    confidence: {{ face_detection_confidence.blazeface }}
    # BlazeFace (MediaPipe) - {{ sentinel_blazeface_variant }}-range variant
{% if sentinel_blazeface_variant == 'short' %}
    edgetpu_model: {{ face_detection_blazeface_short_model }}
{% else %}
    edgetpu_model: {{ face_detection_blazeface_full_model }}
{% endif %}
{% else %}
    confidence: {{ face_detection_confidence.ssd_mobilenet }}
    # SSD MobileNet V2 Face Detection
    edgetpu_model: {{ face_detection_ssd_mobilenet_model }}
{% endif %}
    # CPU/NCS2 fallback paths (used if EdgeTPU unavailable)
    prototxt_path: {{ face_detection_prototxt }}
    model_path: {{ face_detection_caffemodel }}
    target: cpu
{% elif sentinel_accelerator_type == 'ncs2' %}
    # Intel NCS2 Configuration (legacy)
    confidence: {{ face_detection_confidence.ncs2 }}
    prototxt_path: {{ face_detection_prototxt }}
    model_path: {{ face_detection_caffemodel }}
    target: myriad
{% else %}
    # CPU-only Configuration
    confidence: {{ face_detection_confidence.cpu }}
    prototxt_path: {{ face_detection_prototxt }}
    model_path: {{ face_detection_caffemodel }}
    target: cpu
{% endif %}
